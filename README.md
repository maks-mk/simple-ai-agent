# ü§ñ Autonomous AI Agent (LangGraph + MCP + Rich UI)

**v6.5b (Deterministic, Safer Tools & Logging)**

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π **AI-–∞–≥–µ–Ω—Ç** –Ω–∞ –±–∞–∑–µ **LangGraph** –∏ **Model Context Protocol (MCP)**.
–ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤. –õ–æ–≥–∏–∫–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–¥—É–ª—å–Ω—ã.

---

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üß† –£–º–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (The Brain)
- **Hybrid Tool Filter (Deterministic + LLM):** –ê–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö —Ñ–∞–∑–∞—Ö:
    1.  **Exploration:** –î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —á—Ç–µ–Ω–∏—è, –ø–æ–∏—Å–∫–∞ –∏ –ø–∞–º—è—Ç–∏. –ê–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç "—Å–ª–æ–º–∞—Ç—å" —Ñ–∞–π–ª—ã, –ø–æ–∫–∞ –Ω–µ –∏–∑—É—á–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç.
    2.  **Action:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∑–∞–ø–∏—Å–∏ (`write`, `delete`) –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏ —è–≤–Ω–æ–º –ø—Ä–∏–∫–∞–∑–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **Explicit Capability Metadata (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ):** –ö–∞–∂–¥—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏–º–µ–µ—Ç —è–≤–Ω—É—é –º–µ—Ç–∫—É `capability` (`safe`/`write`) –≤ `metadata`. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –∏–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤; –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑ —è–≤–Ω–æ–≥–æ `capability` —Ç—Ä–∞–∫—Ç—É—é—Ç—Å—è –∫–∞–∫ `write` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (safety first). –ê–≥–µ–Ω—Ç –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Ä–µ–µ—Å—Ç—Ä—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (ToolRegistry).
- **Intent Detection (Fast Path):** –ï—Å–ª–∏ –≤—ã –ø—Ä–∏–∫–∞–∑—ã–≤–∞–µ—Ç–µ *"–°–æ–∑–¥–∞–π —Ñ–∞–π–ª"*, —Ñ–∏–ª—å—Ç—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –∏ —Å—Ä–∞–∑—É –≤—ã–¥–∞–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å, –º–∏–Ω—É—è —Ñ–∞–∑—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.
- **LLM Intent Classifier:** –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∏–ª–∏ –Ω–µ—è–≤–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ –±–∞–∑–µ LLM, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å —á–∏—Å—Ç–æ —á–∏—Ç–∞—é—â–∏–º (`read_only`) –∏–ª–∏ –∏–∑–º–µ–Ω—è—é—â–∏–º (`write_action`), —Å fallback –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞.
- **Config Switch:** –í—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∞ —Ñ–ª–∞–≥–æ–º `ENABLE_TOOL_FILTERING=false` –≤ `.env` ‚Äî —Ç–æ–≥–¥–∞ –∞–≥–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `SafetyGuard`.
- **Self-Healing:** –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ENOENT`, `401`), –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Ö –∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–∞ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑ –ø–∞–¥–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.
- **Unified Error Contract:** –í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `Error:`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å —É—Å–ø–µ—Ö –æ—Ç –ø—Ä–æ–≤–∞–ª–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–∑–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞.

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (SafetyGuard)
- **Quality Gate:** –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –Ω–µ —Ç–≤–æ—Ä—á–µ—Å–∫–∞—è, –∞–≥–µ–Ω—Ç –æ–±—è–∑–∞–Ω –Ω–∞–π—Ç–∏ —Ñ–∞–∫—Ç—ã (`web_search`) –∏ –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é.
- **Destructive Actions:** –î–ª—è –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (`delete`, `remove`, `format` –∏ —Ç.–ø.) —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –æ–±—Ö–æ–¥ (bypass) –æ—Ç–∫–ª—é—á–µ–Ω ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏.
- **Loop Guard:** –ñ–µ—Å—Ç–∫–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π.

### üîå –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **Smart Replace:** –ö–∞—Å—Ç–æ–º–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è –≤ –ø–µ—Ä–µ–Ω–æ—Å–∞—Ö —Å—Ç—Ä–æ–∫ (LF/CRLF), –≥–¥–µ –æ–±—ã—á–Ω—ã–µ LLM —á–∞—Å—Ç–æ –æ—à–∏–±–∞—é—Ç—Å—è. –î–µ–π—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–∑–∞—â–∏—Ç–∞ –æ—Ç Path Traversal).
- **System Diagnostics:** –ù–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: IP, Geolocation, CPU/RAM stats, Local Network analysis. –°–µ—Ç–µ–≤–æ–π –∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ª–µ–Ω–∏–≤–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `httpx` —Å fallback –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
- **Long-Term Memory:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–∞–º—è—Ç–∏ (`remember_fact`, `recall_facts`, `forget_fact`) –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Exploration –∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–µ–¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–º–∏. –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø–∞–º—è—Ç–∏ –∏ –º–æ–¥–µ–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.
- **MCP Native:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ Model Context Protocol (–Ω–∞–ø—Ä–∏–º–µ—Ä, Filesystem).
- **Media Tools:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `yt-dlp` –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ. –í–∫–ª—é—á–∞–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º `ENABLE_MEDIA_TOOLS`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ (mp3).
- **Smart Search:** –ì—Ä—É–ø–ø–æ–≤–æ–π –ø–æ–∏—Å–∫ (`batch_web_search`) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤. –ü–æ–∏—Å–∫–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å —á–µ—Ä–µ–∑ `ENABLE_SEARCH_TOOLS` –≤ `.env`. –ì–ª—É–±–æ–∫–∏–π –ø–æ–∏—Å–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º `DEEP_SEARCH`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∏ —Ä–µ—Ç—Ä–∞—è–º–∏, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏ `MAX_RETRIES` –∏ `RETRY_DELAY`.

### üíª –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π CLI
- **Real-time Streaming:** –ü–æ—Ç–æ–∫–æ–≤—ã–π –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–≥–µ–Ω—Ç–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.
- **Token Tracking:** –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ (Native API –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π `tiktoken` –¥–ª—è –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤) —Å –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.
- **Token Budget:** –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã –±—é–¥–∂–µ—Ç–∞ (`TOKEN_BUDGET`). –ï—Å–ª–∏ –ª–∏–º–∏—Ç –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∏—Å—á–µ—Ä–ø–∞–Ω, –∞–≥–µ–Ω—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Ä–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø–æ–∏—Å–∫, —á—Ç–µ–Ω–∏–µ) –∏ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ —Å –∏–º–µ—é—â–∏–º—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.
- **Rich UI:** –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ "–º—ã—à–ª–µ–Ω–∏—è", —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (self-correction, budget alerts, quality gate).
- **Help –ú–µ–Ω—é:** –ö–æ–º–∞–Ω–¥–∞ `/help` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –∫—Ä–∞—Ç–∫–∏–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏. –ö–æ–º–∞–Ω–¥–∞ `/tools` ‚Äî –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –ø—Ä–æ–º–ø—Ç:** –ü—Ä–æ–º–ø—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `User (<cwd>) >`, —á—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–¢—Ä–µ–±—É–µ—Ç—Å—è **Python 3.10+**.

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ venv
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Windows):
venv\Scripts\activate
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Linux/Mac):
source venv/bin/activate
```

### 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`. –í—ã–±–µ—Ä–∏—Ç–µ **–æ–¥–∏–Ω** –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ `env_example.txt`.

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: Google Gemini (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞)
```ini
# --- –í–´–ë–û–† –ü–†–û–í–ê–ô–î–ï–†–ê ---
PROVIDER=gemini

# --- GEMINI SETTINGS ---
GEMINI_API_KEY=AIzaSy...
GEMINI_MODEL=gemini-1.5-flash
# –ò–ª–∏: gemini-1.5-pro

# --- –û–ë–©–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò ---
TAVILY_API_KEY=tvly-...  # –ü–æ–∏—Å–∫ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
MAX_LOOPS=15
TEMPERATURE=0.2
LONG_TERM_MEMORY=true
DEEP_SEARCH=false
ENABLE_SEARCH_TOOLS=true
MODEL_SUPPORTS_TOOLS=true
# –í–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤?
# true - –∞–≥–µ–Ω—Ç –æ–±—è–∑–∞–Ω –≥—É–≥–ª–∏—Ç—å –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é
# false - –∞–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ —Å—Ä–∞–∑—É
SAFETY_GUARD_ENABLED=false
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: OpenAI / DeepSeek / OpenRouter / Pollinations
```ini
# --- –í–´–ë–û–† –ü–†–û–í–ê–ô–î–ï–†–ê ---
PROVIDER=openai

# --- API SETTINGS ---
OPENAI_API_KEY=sk-...

# –î–ª—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ OpenAI:
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o

# –î–ª—è DeepSeek / OpenRouter / Pollinations:
# OPENAI_BASE_URL=https://openrouter.ai/api/v1
# OPENAI_BASE_URL=https://text.pollinations.ai/openai
# OPENAI_MODEL=deepseek-r1

# --- –û–ë–©–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò ---
TAVILY_API_KEY=tvly-...
MAX_LOOPS=15
TEMPERATURE=0.2
LONG_TERM_MEMORY=true
DEEP_SEARCH=false
ENABLE_SEARCH_TOOLS=true
MODEL_SUPPORTS_TOOLS=true
# –í–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤?
# true - –∞–≥–µ–Ω—Ç –æ–±—è–∑–∞–Ω –≥—É–≥–ª–∏—Ç—å –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é
# false - –∞–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ —Å—Ä–∞–∑—É
SAFETY_GUARD_ENABLED=false
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MCP (`mcp.json`)

```json
{
  "filesystem": {
    "command": "npx",
    "args": ["-y", "@modelcontextprotocol/server-filesystem", "."],
    "transport": "stdio",
    "enabled": false
  }
}
```
---

## üìé –°–ø—Ä–∞–≤–∫–∞ –ø–æ .env —Ñ–ª–∞–≥–∞–º

| –§–ª–∞–≥ | –¢–∏–ø / –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- | :--- | :--- |
| PROVIDER | gemini / openai (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: gemini) | –í—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ LLM |
| GEMINI_API_KEY | —Å—Ç—Ä–æ–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è gemini) | –ö–ª—é—á API Gemini |
| GEMINI_MODEL | —Å—Ç—Ä–æ–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: gemini-1.5-flash) | –ú–æ–¥–µ–ª—å Gemini |
| OPENAI_API_KEY | —Å—Ç—Ä–æ–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è openai) | –ö–ª—é—á API –¥–ª—è OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ |
| OPENAI_BASE_URL | —Å—Ç—Ä–æ–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) | –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö API (OpenRouter, Pollinations) |
| OPENAI_MODEL | —Å—Ç—Ä–æ–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: gpt-4o) | –ú–æ–¥–µ–ª—å OpenAI/—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö |
| TEMPERATURE | float (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.2) | –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å/–≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ |
| MAX_LOOPS | int (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 15) | –õ–∏–º–∏—Ç —à–∞–≥–æ–≤ –Ω–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å |
| TOKEN_BUDGET | int (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 30000) | –õ–∏–º–∏—Ç –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤. –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø–æ–∏—Å–∫. |
| DEBUG | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: false) | –í–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ (CLI) |
| ENABLE_SEARCH_TOOLS | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true) | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã |
| DEEP_SEARCH | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: false) | –†–∞–∑—Ä–µ—à–∏—Ç—å –≥–ª—É–±–æ–∫–∏–π –ø–æ–∏—Å–∫ (–¥–æ—Ä–æ–∂–µ –ø–æ —Ç–æ–∫–µ–Ω–∞–º) |
| MAX_RETRIES | int (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3) | –ö–æ–ª-–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ |
| RETRY_DELAY | int (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2) | –ó–∞–¥–µ—Ä–∂–∫–∞ (—Å–µ–∫) –º–µ–∂–¥—É —Ä–µ—Ç—Ä–∞—è–º–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ |
| MODEL_SUPPORTS_TOOLS | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true) | –£–∫–∞–∑—ã–≤–∞–µ—Ç, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ –º–æ–¥–µ–ª—å –≤—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |
| LONG_TERM_MEMORY | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: false) | –í–∫–ª—é—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç–∏ |
| ENABLE_SYSTEM_TOOLS | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true) | –í–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (—Å–µ—Ç—å/–∂–µ–ª–µ–∑–æ) |
| ENABLE_MEDIA_TOOLS | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: false) | –í–∫–ª—é—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–µ–¥–∏–∞ (yt-dlp) |
| SESSION_SIZE | int (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 20) | –ü–æ—Ä–æ–≥ –¥–ª–∏–Ω—ã —Å–µ—Å—Å–∏–∏ –¥–ª—è —Å–∞–º–º–∞—Ä–∏ |
| SUMMARY_KEEP_LAST | int (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 4) | –°–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ —Å–∂–∞—Ç–∏—è |
| SAFETY_GUARD_ENABLED | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true) | –í–∫–ª—é—á–∏—Ç—å Quality Gate –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞–ø–∏—Å–∏/—É–¥–∞–ª–µ–Ω–∏—è |
| ENABLE_TOOL_FILTERING | bool (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true) | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —É–º–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (—Ñ–∞–∑—ã + LLM-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä) |
| TAVILY_API_KEY | —Å—Ç—Ä–æ–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –ø–æ–∏—Å–∫–∞) | –ö–ª—é—á API –¥–ª—è Tavily (search/fetch/crawl) |
| PROMPT_PATH | –ø—É—Ç—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ./prompt.txt) | –ü—É—Ç—å –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –ø—Ä–æ–º–ø—Ç—É |

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- ENABLE_SEARCH_TOOLS —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫–æ–π –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π Tavily-–∫–ª–∏–µ–Ω—Ç–∞.
- DEEP_SEARCH –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.
- MAX_RETRIES –∏ RETRY_DELAY —É–ø—Ä–∞–≤–ª—è—é—Ç —Ä–µ—Ç—Ä–∞—è–º–∏ –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (Tavily).
- SESSION_SIZE –∏ SUMMARY_KEEP_LAST —É–ø—Ä–∞–≤–ª—è—é—Ç –º–µ—Ö–∞–Ω–∏–∑–º–æ–º —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
- ENABLE_TOOL_FILTERING –≤–∫–ª—é—á–∞–µ—Ç —Ñ–∞–∑–æ–≤—É—é/LLM-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ü—Ä–∏ `false` –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–≥–¥–∞, –Ω–æ `SafetyGuard` –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –æ–ø–∞—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏/—É–¥–∞–ª–µ–Ω–∏—è.

## üèÉ‚Äç‚ôÇÔ∏è –ó–∞–ø—É—Å–∫

```bash
python agent_cli.py
```


**–ö–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ —á–∞—Ç–∞:**
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º.
- `/tools` ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
- `exit` / `quit` ‚Äî –í—ã—Ö–æ–¥.
- `reset` / `clear` ‚Äî –°–±—Ä–æ—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–Ω–æ–≤–∞—è —Å–µ—Å—Å–∏—è).
- `Alt + Enter` ‚Äî –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –ö–æ—Ä–Ω–µ–≤—ã–µ —Ñ–∞–π–ª—ã
| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- | :--- |
| `agent.py` | **Core Flow.** –ì—Ä–∞—Ñ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è. |
| `agent_cli.py` | **UI.** –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞, —Å–ø–∏–Ω–Ω–µ—Ä—ã. |
| `prompt.txt` | –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é). |
| `mcp.json` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP-—Å–µ—Ä–≤–µ—Ä–æ–≤. |
| `env_example.txt` | –ü—Ä–∏–º–µ—Ä `.env` —Å–æ –≤—Å–µ–º–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏. |
| `requirements.txt` | Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. |
| `win-cli-config.json` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Windows CLI/—Å–±–æ—Ä–∫–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è). |

### –ú–æ–¥—É–ª–∏ `core/` (–Ø–¥—Ä–æ)
| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- | :--- |
| `state.py` | –°–æ—Å—Ç–æ—è–Ω–∏–µ –≥—Ä–∞—Ñ–∞ (–≤–∫–ª—é—á–∞—è `allowed_tools`). |
| `config.py` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Pydantic, –≤—ã–±–æ—Ä LLM. |
| `logging_config.py` | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (handlers/—Ñ–æ—Ä–º–∞—Ç). |
| `safety_guard.py` | –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Quality Gate). |
| `tool_validator.py` | –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—à–∏–±–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. |
| `tool_sanitizer.py` | –û—á–∏—Å—Ç–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –ø—É—Ç–µ–π. |
| `utils.py` | –ü–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤. |
| `constants.py` | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `BASE_DIR` –¥–ª—è –ø—É—Ç–µ–π –∏ `.env`. |

### –ú–æ–¥—É–ª–∏ `tools/` (–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- | :--- |
| `tool_registry.py` | –ó–∞–≥—Ä—É–∑—á–∏–∫ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç `capability` –∏ fallback-—ç–≤—Ä–∏—Å—Ç–∏–∫—É). |
| `patch_tool.py` | **Smart Replace** (–Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ). |
| `system_tools.py` | –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∏ —Å–µ—Ç–∏. |
| `search_tools.py` | –ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ (Tavily). |
| `delete_tools.py` | –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ. |
| `memory_manager.py` | –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å (remember/recall/forget). |

### –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `dist/` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
| –ü–∞–ø–∫–∞/—Ñ–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- | :--- |
| `dist/` | –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–±–æ—Ä–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.exe`) –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã. |

---

## üõ† –ì—Ä–∞—Ñ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (Logic Flow)

```mermaid
graph TD
    START --> Summarize
    Summarize --> UpdateStep
    UpdateStep --> TokenBudgetGuard
    TokenBudgetGuard --> ToolFilter
    
    subgraph Decision Making
        ToolFilter -->|Exploration Phase| Agent
        ToolFilter -->|Action Phase| Agent
    end
    
    Agent -- Tool Call --> ToolsAndValidate
    ToolsAndValidate -- Output / Error --> ToolFilter
    
    Agent -- Final Answer --> END
    Agent -- Max Steps --> LoopGuard --> END
```

---

## üÜï –ù–æ–≤–æ–µ –≤ v6.3b

- –£—Å–∏–ª–µ–Ω —Ä–µ–µ—Å—Ç—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ `ToolRegistry.get_tool_capability` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é deny-by-default ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑ —è–≤–Ω–æ–π –º–µ—Ç–∫–∏ `capability` —Å—á–∏—Ç–∞—é—Ç—Å—è `write` –∏ –ø–æ–ø–∞–¥–∞—é—Ç –ø–æ–¥ –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (`system_tools.py`) –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –Ω–∞ –±–∞–∑–µ `httpx` –≤–º–µ—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ `requests`, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∏—à–µ—Ç –≤ —Ñ–∞–π–ª `agent.log` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—á–µ—Ä–µ–∑ `core/logging_config.py`), –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å.
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –∏–∑ `prompt.txt` —Ç–µ–ø–µ—Ä—å –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É, –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –∏ fallback-—Å—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–∞; —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–º–ø—Ç–æ–º.
- –ú–µ—Ö–∞–Ω–∏–∑–º —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–ª–∏–Ω—É –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ LLM, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∞—Å—Ö–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –¥–ª–∏–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏—è—Ö.
- –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω CLI (`agent_cli.py`): –≤—ã–Ω–µ—Å–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ (`StreamProcessor`) —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –º—ã—Å–ª–µ–π –∞–≥–µ–Ω—Ç–∞, –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ç–æ–∫–µ–Ω–∞–º.

## üÜï –ù–æ–≤–æ–µ –≤ v6.1b

- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–µ–π: `BASE_DIR` –≤—ã–Ω–µ—Å–µ–Ω –≤ [constants.py](file:///d:/py_projects/simple_ai_agent/agent+stategraph/v6.3b/core/constants.py), –¥—É–±–ª–∏—Ä—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ —É–±—Ä–∞–Ω–∞ –∏–∑ `config.py` –∏ `agent_cli.py`. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π –∏–∑ –∫–æ—Ä–Ω—è —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sys.path.insert(0, BASE_DIR)` –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤.
- ToolRegistry —Ç–µ–ø–µ—Ä—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç `capability` –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏; –∞–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é.
- SafetyGuard —É—Å–∏–ª–µ–Ω: –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –∫–æ—Ä–Ω–∏ –¥–µ–π—Å—Ç–≤–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `delete`, `remove`), –æ—Ç–∫–ª—é—á–µ–Ω —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π bypass –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —É—Ç–æ—á–Ω–µ–Ω—ã —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞ (–≤–∫–ª—é—á–∞—è —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏). –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å `SAFETY_GUARD_ENABLED` —á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `.env`.
- –ü–æ–∏—Å–∫ —Å—Ç–∞–ª —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º: –¥–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `ENABLE_SEARCH_TOOLS` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤; –≥–ª—É–±–æ–∫–∏–π –ø–æ–∏—Å–∫ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è `DEEP_SEARCH`.
- –ü–æ–∏—Å–∫ —Å—Ç–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ: —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã —Ç–µ–∫—Å—Ç—ã –æ—à–∏–±–æ–∫; –¥–æ–±–∞–≤–ª–µ–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω—ã–π rate limit, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ—Ç—Ä–∞–µ–≤ (`MAX_RETRIES`, `RETRY_DELAY`) –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π in-memory –∫—ç—à —Å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–æ–π.
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–∞–º—è—Ç–∏ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –ª–µ–Ω–∏–≤—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é (—Ä–µ—Å—É—Ä—Å—ã –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏).
- CLI —É–ª—É—á—à–µ–Ω: –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã `/help` –∏ `/tools`; –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏; –ø—Ä–æ–º–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.
